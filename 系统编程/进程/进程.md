## 进程相关概念

### 程序和进程

程序，是指编译好的二进制文件，在磁盘上，不占用系统资源(cpu、内存、打开的文件、设备、锁....)

进程，是一个抽象的概念，与操作系统原理联系紧密。进程是活跃的程序，占用系统资源。在内存中执行。(程序运行起来，产生一个进程)

程序 → 剧本(纸)		进程 → 戏(舞台、演员、灯光、道具...)

同一个剧本可以在多个舞台同时上演。同样，同一个程序也可以加载为不同的进程(彼此之间互不影响)

如：同时开两个终端。各自都有一个bash但彼此ID不同。

### 并发

并发，在[操作系统](http://baike.baidu.com/view/880.htm)中，一个时间段中有多个进程都处于已启动运行到运行完毕之间的状态。但，任一个时刻点上仍只有一个进程在运行。

例如，当下，我们使用计算机时可以边听音乐边聊天边上网。 若笼统的将他们均看做一个进程的话，为什么可以同时运行呢，因为并发。

![img](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/wps1.jpg) 

分时复用cpu

 

### 单道程序设计 

所有进程一个一个排对执行。若A阻塞，B只能等待，即使CPU处于空闲状态。而在人机交互时阻塞的出现时必然的。所有这种模型在系统资源利用上及其不合理，在计算机发展历史上存在不久，大部分便被淘汰了。

### 多道程序设计

在计算机内存中同时存放几道相互独立的程序，它们在管理程序控制之下，相互穿插的运行。多道程序设计必须有[硬件基础](http://baike.baidu.com/view/4419390.htm)作为保证。

**时钟中断**即为多道程序设计模型的理论基础。 并发时，任意进程在执行期间都不希望放弃cpu。因此系统需要一种强制让进程让出cpu资源的手段。时钟中断有硬件基础作为保障，对进程而言不可抗拒。 操作系统中的中断处理函数，来负责调度程序执行。

在多道程序设计模型中，多个进程轮流使用CPU (分时复用CPU资源)。而当下常见CPU为纳秒级，1秒可以执行大约10亿条指令。由于人眼的反应速度是毫秒级，所以看似同时在运行。

1s = 1000ms, 1ms = 1000us, 1us = 1000ns   1000000000 

实质上，并发是宏观并行，微观串行！			-----推动了计算机蓬勃发展，将人类引入了多媒体时代。

### CPU和MMU

![img](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/wps2.jpg) 

中央处理器(CPU)

 

![img](C:\Users\LENOVO\AppData\Local\Temp\ksohtml21704\wps3.jpg) 

内存管理单元MMU

### 进程控制块PCB

我们知道，每个进程在内核中都有一个进程控制块（PCB）来维护进程相关的信息，Linux内核的进程控制块是task_struct结构体。

`/usr/src/linux-headers-3.16.0-30/include/linux/sched.h`文件中可以查看`struct task_struct` 结构体定义。其内部成员有很多，我们重点掌握以下部分即可：

- 进程id。系统中每个进程有唯一的id，在C语言中用`pid_t`类型表示，其实就是一个非负整数。

- 进程的状态，有就绪、运行、挂起、停止等状态。

- 进程切换时需要保存和恢复的一些CPU寄存器。

- 描述虚拟地址空间的信息。

- 描述控制终端的信息。

- 当前工作目录（Current Working Directory）。

- umask掩码。

- 文件描述符表，包含很多指向file结构体的指针。

- 和信号相关的信息。

- 用户id和组id。

- 会话（Session）和进程组。

- 进程可以使用的资源上限（Resource Limit）。

### 进程状态

进程基本的状态有5种。分别为初始态，就绪态，运行态，挂起态与终止态。其中初始态为进程准备阶段，常与就绪态结合来看。

![img](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/wps4.jpg) 

![image-20210821154224714](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20210821154224714.png)

